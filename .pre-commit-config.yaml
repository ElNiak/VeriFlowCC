# =============================================================================
# ‚öôÔ∏è GLOBAL PRE-COMMIT CONFIGURATION
# =============================================================================

default_language_version:
  python: python3.10

fail_fast: false

# Exclude .claude directory from all hooks
exclude: '^\.claude/'

# TODO: add check Check for placeholders + no mock

repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: check-yaml
        name: "YAML ¬∑ Check YAML files"
      - id: end-of-file-fixer
        name: "End of File ¬∑ Fix end of file"
      - id: trailing-whitespace
        name: "Whitespace ¬∑ Remove trailing whitespace"
      - id: check-added-large-files
        name: "Large Files ¬∑ Check for large files"
        args: [--maxkb=1024]
      - id: check-merge-conflict
        name: "Merge Conflict ¬∑ Check for merge conflicts"
      - id: check-toml
        name: "TOML ¬∑ Check TOML files"
      - id: debug-statements
        name: "Debug Statements ¬∑ Remove debug statements"

  # TODO: do not allow backups/tmp files to be committed

  # =============================================================================
  # üêç PYTHON SPECIFIC HOOKS
  # =============================================================================

  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.5.0
    hooks:
      - id: ruff
        name: "üêç python ¬∑ Lint with Ruff"
        args: [--fix]
      - id: ruff-format
        name: "üêç python ¬∑ Format with Ruff"

  - repo: local
    hooks:
      - id: mypy
        name: "üêç python ¬∑ Type check with Mypy"
        entry: uv run mypy
        language: system
        types: [python]
        args: [--ignore-missing-imports, --no-strict-optional, verifflowcc]
        require_serial: false
        pass_filenames: false

  - repo: https://github.com/abravalheri/validate-pyproject
    rev: v0.23
    hooks:
      - id: validate-pyproject
        name: "üêç python ¬∑ Validate pyproject.toml"
        additional_dependencies:
          ["validate-pyproject-schema-store[all]>=2024.11.11"]

  # =============================================================================
  # üü® JAVASCRIPT SPECIFIC HOOKS
  # =============================================================================

  - repo: https://github.com/biomejs/pre-commit
    rev: "v0.6.1"
    hooks:
      - id: biome-check
        name: "üü® javascript ¬∑ Lint, format, and safe fixes with Biome"
        additional_dependencies: ["@biomejs/biome@1.9.4"]

  # =============================================================================
  # üü© SECURITY SPECIFIC HOOKS
  # =============================================================================

  - repo: https://github.com/gitleaks/gitleaks
    rev: v8.18.0
    hooks:
      - id: gitleaks
        name: "Gitleaks ¬∑ Scan for secrets in git history"

  # =============================================================================
  # üìù MARKDOWN SPECIFIC HOOKS
  # =============================================================================

  - repo: https://github.com/hukkin/mdformat
    rev: 0.7.21
    hooks:
      - id: mdformat
        name: "üìù markdown ¬∑ Format markdown"
        additional_dependencies:
          - mdformat-gfm # GitHub-Flavored Markdown support
          - mdformat-ruff # Python code formatting
          - mdformat-frontmatter # YAML frontmatter support
          - ruff # Required for mdformat-ruff

  # =============================================================================
  # üóÑÔ∏è DATABASE & SQL VALIDATION
  # =============================================================================

  # SQLFluff - SQL linting for PostgreSQL/TimescaleDB
  - repo: https://github.com/sqlfluff/sqlfluff
    rev: 3.0.7
    hooks:
      - id: sqlfluff-lint
        name: SQL lint (PostgreSQL)
        args: [--dialect, postgres, --disable-progress-bar]
        types: [sql]
      - id: sqlfluff-fix
        name: SQL auto-fix
        args: [--dialect, postgres, --disable-progress-bar]
        types: [sql]
